<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Creating Web Experiences with users in mind</title>
    <meta name="description" content="Talk at HTML5 Dev Conf on April 1st 2013">
    <meta name="author" content="Divya Manian">
    <link rel=stylesheet href=http://nimbu.in/css/impress.css>
    <script>
        var anelm = document.getElementById('impress');
        
    </script>
</head>

<body class="impress-not-supported">
<div id="impress">
    
        <div class="step  middle" data-x="0" data-y="0" data-z="" data-scale="2">
            <h1>Blend Modes & Filter Effects</h1>
<h2><a href="http://twitter.com/divya">@divya</a> â€¢ Product Manager, Adobe</h2>

        </div>
    
        <div class="step " data-x="5000" data-y="0" data-z="" data-scale="2">
            <h1><a href="http://html5please.com">HTML5 Please</a> / <a href="http://html5boilerplate.com">HTML5 Boilerplate</a></h1>
        </div>
    
        <div class="step " data-x="10000" data-y="0" data-z="" data-scale="2">
            <h1>Filter Effects</h1>
        </div>
    
        <div class="step " data-x="15000" data-y="0" data-z="" data-scale="2">
            <h2>Creation of FX Task Force</h2>
            <p>Originally drafted 25 October 2012</p>
        </div>
    
        <div class="step  middle" data-x="20000" data-y="0" data-z="" data-scale="2">
            <h1>Based on SVG Filters</h1>
            <p>Introduced by Apple.</p>
        </div>
    
        <div class="step  middle" data-x="25000" data-y="0" data-z="" data-scale="2">
            <h2>Available since Chrome 18, Safari 6. </h2>

        </div>
    
        <div class="step  middle" data-x="30000" data-y="0" data-z="" data-scale="2">
            <h1>What is it?</h1>

        </div>
    
        <div class="step " data-x="35000" data-y="0" data-z="" data-scale="2">
            <a href="http://www.flickr.com/photos/arkku/471713062/" title="Filter stack by Arkku, on Flickr"><img src="http://farm1.staticflickr.com/227/471713062_61a8e66ca8.jpg" width="500" height="334" alt="Filter stack"></a>
        </div>
    
        <div class="step  middle" data-x="40000" data-y="0" data-z="" data-scale="2">
            <h2>Define the color of an output pixel based on calculations on input pixel color</h2>

        </div>
    
        <div class="step " data-x="45000" data-y="0" data-z="" data-scale="2">
            <h2>Sample Filter: Blur</h2>
            <p>Demo</p>
        </div>
    
        <div class="step " data-x="50000" data-y="0" data-z="" data-scale="2">
            <h2>Wait, we have seen this before!</h2>
        </div>
    
        <div class="step " data-x="55000" data-y="0" data-z="" data-scale="2">
            <p>Box Shadows, Text Shadows</p>

        </div>
    
        <div class="step  middle" data-x="60000" data-y="0" data-z="" data-scale="2">
            <p><a href="http://dbaron.org/log/20110225-blur-radius">David Baron's post on blur implementation in browsers</a></p>
        </div>
    
        <div class="step  middle" data-x="65000" data-y="0" data-z="" data-scale="2">
            <h1>Layout/Reflow</h1>
            <p>Calculation of information required to display visible DOM nodes.</p>

        </div>
    
        <div class="step  middle" data-x="70000" data-y="0" data-z="" data-scale="2">
            <h1>When does it happen?</h1>

        </div>
    
        <div class="step  middle" data-x="75000" data-y="0" data-z="" data-scale="2">
            <p>Style changes</p>

        </div>
    
        <div class="step  middle" data-x="80000" data-y="0" data-z="" data-scale="2">
            <p>Fetching of layout values/scroll values <a href="http://www.html5rocks.com/en/tutorials/speed/rendering/too-much-layout.html">Demo</a> - <a href="http://www.html5rocks.com/en/tutorials/speed/rendering/too-much-layout-fixed.html">Fixed</a></p>

        </div>
    
        <div class="step " data-x="85000" data-y="0" data-z="" data-scale="2">
            <p>Adding/removing elements</p>

        </div>
    
        <div class="step " data-x="90000" data-y="0" data-z="" data-scale="2">
            <h1>How to detect Layout/Reflow</h1>
            <p><a href="http://codepen.io/nimbupani/full/nkbfC">Demo</a></p>
        </div>
    
        <div class="step " data-x="95000" data-y="0" data-z="" data-scale="2">
            <h2>Avoid it like a plague</h2>

        </div>
    
        <div class="step " data-x="100000" data-y="0" data-z="" data-scale="2">
            <h2>How to minimize Layout?</h2>

        </div>
    
        <div class="step " data-x="105000" data-y="0" data-z="" data-scale="2">
            <p>Move content away from the flow.</p>

        </div>
    
        <div class="step " data-x="110000" data-y="0" data-z="" data-scale="2">
            <p>Use only on the element with least children.</p>

        </div>
    
        <div class="step " data-x="115000" data-y="0" data-z="" data-scale="2">
            <p>Batch reading/writing <a href="http://gent.ilcore.com/2011/03/how-not-to-trigger-layout-in-webkit.html">layout values</a></p>

        </div>
    
        <div class="step " data-x="120000" data-y="0" data-z="" data-scale="2">
            <p>Apply layout changes on <code>requestAnimationFrame</code></p>

        </div>
    
        <div class="step " data-x="125000" data-y="0" data-z="" data-scale="2">
            <h1><code>requestAnimationFrame</code></h1>
        </div>
    
        <div class="step " data-x="130000" data-y="0" data-z="" data-scale="2">
            <h1>60fps</h1>
            <p><a href="https://vimeo.com/64733304">Rendering without the lumpy bits</a></p>
        </div>
    
        <div class="step " data-x="135000" data-y="0" data-z="" data-scale="2">
            <p>new frame every 16.67ms</p>
        </div>
    
        <div class="step " data-x="140000" data-y="0" data-z="" data-scale="2">
            <p> <code>setInterval</code>, <code>setTimeout</code> <a href="http://www.html5rocks.com/en/tutorials/speed/rendering/raf-motivation.html">Drops frames if not synched to Browser refresh rate</a></p>
        </div>
    
        <div class="step " data-x="145000" data-y="0" data-z="" data-scale="2">
            <h1>Minimize Style Changes</h1>
        </div>
    
        <div class="step " data-x="150000" data-y="0" data-z="" data-scale="2">
            <h1>Avoid</h1>
            <ul>
                <li>Sibling selectors</li>
                <li>Generic Selectors</li>
            </ul>
        </div>
    
        <div class="step " data-x="155000" data-y="0" data-z="" data-scale="2">
            <h1>Use</h1>
            <ul>
                <li>Specific classes</li>
            </ul>
        </div>
    
        <div class="step " data-x="160000" data-y="0" data-z="" data-scale="2">
            <h1>Paints</h1>
            <p>Browser changes the pixel values of an area of the viewport</p>
        </div>
    
        <div class="step " data-x="165000" data-y="0" data-z="" data-scale="2">
            <h1>When does it happen?</h1>
            <ul>
                <li>Scrolling</li>
                <li>Hover, Mouse moves</li>
                <li>Basically all the time</li>
            </ul>
        </div>
    
        <div class="step " data-x="170000" data-y="0" data-z="" data-scale="2">
            <h1>Typical Painting Experience</h1>
            <p><img src="https://lh5.googleusercontent.com/mTQIYRturbWjgHKL2dRFEKPLXQd479b5X9kK5u_udyfr9WT8nR3gNdWm803v-OFL9gACxyZ8s4M2JwjtLk0jqLEpl9JV5X_PUID19QNPpSvrWEmdULg"></p>

        </div>
    
        <div class="step " data-x="175000" data-y="0" data-z="" data-scale="2">
            <h1>Go through Stacking contexts</h1>
        </div>
    
        <div class="step " data-x="180000" data-y="0" data-z="" data-scale="2">
            <ul>
                <li>Root Object (html)
                <li><code>transform</code>, <code>position: relative</code>, <code>position: absolute</code></li>
                <li>opacity < 1</li>
                <li>CSS Filter</li>
                <li>overflow is set</li>
            </ul>
        </div>
    
        <div class="step " data-x="185000" data-y="0" data-z="" data-scale="2">
            <h1>Create Render Layers</h1>

        </div>
    
        <div class="step " data-x="190000" data-y="0" data-z="" data-scale="2">
            <ul>
                <li>Each Stacking context creates a Render Layer</li>
                <li>WebGL or accelerated canvas has own Render Layer</li>
                <li>So does Video or Accelerated Canvas Element</li>
            </ul>
        </div>
    
        <div class="step " data-x="195000" data-y="0" data-z="" data-scale="2">
            <h2>Paint to ONE Bitmap</h2>

        </div>
    
        <div class="step " data-x="200000" data-y="0" data-z="" data-scale="2">
            <h2>What happens to painting when Hardware-Acceleration is Enabled?</h2>

        </div>
    
        <div class="step " data-x="205000" data-y="0" data-z="" data-scale="2">
            <ul>
                <li>Many bitmaps not just ONE (hardware-accelerated bitmaps have a 'backing store')</li>
                <li>HW-accelerated bitmaps are <em>directly rendered</em> by GPU</li>
                <li>Browser determines which render layers go into which bitmap</li>
            </ul>
        </div>
    
        <div class="step " data-x="210000" data-y="0" data-z="" data-scale="2">
            <h2>How does the browser decide which bitmaps are HW-accelerated?</h2>
            <ul>
                <li>Intense painting occurs: e.g. video, WebGL or canvas</li>
                <li>3D Transformed elements</li>
                <li>Filters, masks, reflections, opacity, transitions, animations</li>
                <li><code>position: fixed</code></li>
                <li>content overlapping existing GPU-rendered bitmaps</li>
            </ul>
        </div>
    
        <div class="step " data-x="215000" data-y="0" data-z="" data-scale="2">
            <h1>How can you find out how many bitmaps?</h1>
            <p><a href="http://www.html5rocks.com/static/demos/movikantirevo/build4.html">Demo</a></p>
        </div>
    
        <div class="step " data-x="220000" data-y="0" data-z="" data-scale="2">
            <h2>GPU!!</h2>
            <p><img src="http://images2.fanpop.com/image/photos/14200000/CS-source-wallpaper-counter-strike-14231626-1024-768.jpg"></p>
        </div>
    
        <div class="step " data-x="225000" data-y="0" data-z="" data-scale="2">
            <p>Like CPU but optimized for processing large blocks of data in parallel</p>
        </div>
    
        <div class="step " data-x="230000" data-y="0" data-z="" data-scale="2">
            <ul>
                <li>No Repaints, relayouts [Demo]</li>
                <li>If area is large, tiled textures to swap in and out textures quickly. </li>
                <li>Larger power consumption</li>
            </ul>
        </div>
    
        <div class="step " data-x="235000" data-y="0" data-z="" data-scale="2">
            <h1>Flicker happens</h1>
            <ul>
                <li>GPU scrambles to swap new textures into tiles as you scroll. </li>
                <li>Browser is switching from CPU rendering to a GPU rendering</li>
            </ul>
        </div>
        <div class="step " data-x="240000" data-y="0" data-z="" data-scale="2">
            <h1>GPU reduces burden on CPU</h1>
            <ul>
                <li>Limited by Memory</li>
                <li>Each backing store (what?) uses dimension of texture * 4 bytes</li>
                <li>More layers, more memory use: Retina is 4x, Retina zoomed texture is 16x!</li>                
            </ul>
        </div>
        <div class="step " data-x="245000" data-y="0" data-z="" data-scale="2">
            <h1>Memory</h1>
            <ul>
                <li>All data & GPU textures are stored</li>
                <li>Android & iOS can force quit browser or webview to free memory (unlike Desktop)</li>
                <li>More apps open, smaller the size of memory available to your page</li>                
            </ul>
        </div>            
        <div class="step " data-x="250000" data-y="0" data-z="" data-scale="2">
            <h1>Reduce Memory Usage</h1>
            <ul>
                <li>Smaller images (dimensions of image * 4 bytes)</li>
                <li>Smaller JavaScript files/CSS files</li>
                <li>Smaller textures to GPU</li>
                <li>Fewer GPU layers</li>                
            </ul>
        </div>                        
        <div class="step " data-x="255000" data-y="0" data-z="" data-scale="2">
            <h1>Reduce CPU/GPU switching</h1>
            <ul>
                <li>Do animation only in GPU <a href="http://codepen.io/nimbupani/pen/GCxIn">Demo</a></li>
                <li>Don't animate <code>z-index</code></li>
                <li>Use Opacity to toggle visibility of GPU-accelerated content</li>                
            </ul>
        </div>                        
        <div class="step " data-x="260000" data-y="0" data-z="" data-scale="2">
            <h1>Why Opacity?</h1>
            <ul>
                <li>Textures remain in the GPU</li>
                <li><code>visibility:hidden</code> removes textures from GPU <a href="">Demo</a></li>
                <li><code>display: none</code> causes repaints</li>                
                <li>removing elements from DOM causes style recalculations, layout, repaint, firing of events. </li>
            </ul>
        </div>    
        <div class="step " data-x="265000" data-y="0" data-z="" data-scale="2">
            <h1>In Summary</h1>
            <ul>
                <li>Rendering is a beast</li>
                <li>Use specific class names</li>
                <li>Do layout, repaint, GPU acceleration sparingly</li>                
                <li>Memory can quickly get out of hand!</li>
                <li>Use tools to test!</li>
            </ul>
        </div>                
    
    </div>
<div class="hint">
    <p>Use a spacebar or arrow keys to navigate</p>
</div>
<script>
if ("ontouchstart" in document.documentElement) {
    document.querySelector(".hint").innerHTML = "<p>Tap on the left or right to navigate</p>";
}
</script>
<script src="http://nimbu.in/js/impress.js"></script>
<script>impress().init();</script>
</body>
</html>